@patch('app.schemas.Session')
@patch('app.schemas.query')
async def test_get_incident_count_by_app_id_success(mock_query, mock_session):
    # Mock query results
    mock_query.all.return_value = [
        (1, 10),
        (2, 20)
    ]

    # Call the function
    result = await get_incident_count_by_app_id()

    # Assert expected values
    assert len(result) == 2
    assert result[0].ci_wf_appid == 1
    assert result[0].count == 10
    assert result[1].ci_wf_appid == 2
    assert result[1].count == 20